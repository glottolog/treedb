version: ~> 1.0
dist: focal
language: python
cache: pip
python:
  - "3.6"
  - "3.7"
  - "3.8"
  - "3.9"
env:
  - ARGS=
  - ARGS=--run-writes
  - ARGS=--glottolog-tag=master
jobs:
  exclude:
    - python: 3.6
      env: ARGS=--run-writes
    - python: 3.7
      env: ARGS=--run-writes
    - python: 3.8
      env: ARGS=--run-writes
    - python: 3.6
      env: ARGS=--glottolog-tag=master
    - python: 3.7
      env: ARGS=--glottolog-tag=master
    - python: 3.8
      env: ARGS=--glottolog-tag=master
    - python: 3.9
      env: ARGS=
install: pip install .[test,pretty,pandas] codecov
script: ./run-tests.py --loglevel-debug $ARGS
before_cache: rm -f $HOME/.cache/pip/log/debug.log
after_success: codecov
